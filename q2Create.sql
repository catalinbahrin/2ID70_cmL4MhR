CREATE INDEX ind_srid ON CourseRegistrations(StudentRegistrationId);
CREATE MATERIALIZED VIEW Info AS (SELECT cr.StudentRegistrationId, SUM(case when Grade >= 5 then cr.Grade * c.ECTS  else 0 end)/SUM(case when Grade >= 5 then ECTS*1.0 end) AS GPA, SUM(case when Grade >= 5 then ECTS else 0 end) AS ObtainedECTS FROM CourseRegistrations cr, CourseOffers co, Courses c WHERE cr.CourseOfferId = co.CourseOfferId AND co.courseId = c.courseId GROUP BY cr.StudentRegistrationId);
CREATE MATERIALIZED VIEW Calc AS (SELECT CourseId, Grade, COUNT(*) AS nr FROM CourseOffers co, CourseRegistrations cr WHERE co.CourseOfferId = cr.CourseOfferID AND cr.Grade is not null GROUP BY CourseId, grade); 
