SELECT c.CourseName, cr.Grade FROM CourseRegistrations cr, CourseOffers co, Courses c, StudentRegistrationsToDegrees srd WHERE srd.StudentId = %1% AND srd.DegreeId = %2% AND cr.Grade >= 5 AND srd.StudentRegistrationId = cr.StudentRegistrationId AND cr.CourseOfferId = co.CourseOfferId AND co.CourseId = c.CourseId ORDER BY co.Year, co.Quartile;
SELECT DISTINCT srd.StudentId FROM StudentRegistrationsToDegrees srd, Info i, Degrees d WHERE srd.StudentRegistrationId = i.StudentRegistrationId AND i.failed >= 5 AND i.GPA > %1% AND d.DegreeId = srd.DegreeId AND d.TotalEcts <= i.ObtainedEcts ORDER BY srd.StudentId; 
WITH ActiveStudents(DegreeId, nrTotal, nrFemale) AS (SELECT d.DegreeId,  COUNT(*), SUM(case when s.Gender = 'F' then 1 else 0 end) FROM StudentRegistrationsToDegrees srd, Degrees d, Students s, Info i WHERE d.DegreeId = srd.DegreeId AND srd.StudentId = s.StudentId AND i.StudentRegistrationId = srd.StudentRegistrationId AND i.ObtainedECTS < d.TotalECTS GROUP BY d.degreeId) SELECT DegreeId, nrFemale/(nrTotal * 1.0) AS pecentage FROM ActiveStudents ORDER BY DegreeId;
WITH AllStudentsByG(Dept, Gender, nr) AS (SELECT d.Dept, s.Gender, COUNT(*) FROM StudentRegistrationsToDegrees srd, Degrees d, Students s WHERE d.DegreeId = srd.DegreeId AND s.StudentId = srd.StudentId GROUP BY Dept, Gender), TotalStudents(Dept, nr) AS (SELECT asbg.Dept, SUM(asbg.nr) FROM AllStudentsByG asbg GROUP BY asbg.Dept) SELECT asbg.nr/(ts.nr*1.0) AS percentage FROM AllStudentsByG asbg, TotalStudents ts WHERE asbg.Gender = 'F' AND asbg.Dept = ts.Dept AND ts.Dept = %1%;
WITH Calc(CourseId, passed, total) AS (SELECT CourseId, sum(case when Grade >= %1% then 1 else 0 end), Count(*) FROM CourseOffers co, CourseRegistrations cr WHERE co.CourseOfferId = cr.CourseOfferId GROUP BY CourseId) SELECT CourseId, passed/(total * 1.0) AS pecentage FROM Calc ORDER BY CourseId;
SELECT * From GoodStudents WHERE nr >= %1%;
SELECT d.DegreeId, s.BirthYearStudent, s.Gender, AVG(i.GPA) FROM StudentRegistrationsToDegrees srd, Students s, Degrees d, Info i WHERE d.DegreeId = srd.DegreeId AND srd.StudentId = s.StudentId AND i.StudentRegistrationId = srd.StudentRegistrationId AND i.ObtainedECTS < d.TotalECTS GROUP BY CUBE(d.DegreeId, s.BirthYearStudent, s.Gender) ORDER BY d.DegreeId, s.BirthYearStudent, s.Gender;
WITH NecessarySA(CourseOfferId, nr) AS (SELECT cr.CourseOfferId, CEILING(COUNT(cr.StudentRegistrationID)/(50.0)) FROM CourseRegistrations cr GROUP BY cr.CourseOfferId), ActualSA(CourseOfferId, nr) AS (SELECT CourseOfferId, COUNT(StudentRegistrationId) FROM StudentAssistants GROUP BY CourseOfferId) SELECT c.CourseName, co.Year, co.Quartile FROM NecessarySA nsa, CourseOffers co, Courses c, ActualSA asa WHERE co.CourseOfferId = nsa.CourseOfferId AND co.CourseId = c.CourseId AND asa.CourseOfferId = co.CourseOfferId AND nsa.nr < asa.nr ORDER BY co.CourseOfferId; 
