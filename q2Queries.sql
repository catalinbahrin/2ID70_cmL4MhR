SELECT c.CourseName, cr.Grade FROM CourseRegistrations cr, CourseOffers co, Courses c, StudentRegistrationsToDegrees srd WHERE srd.StudentId = %1% AND srd.DegreeId = %2% AND cr.Grade >= 5 AND srd.StudentRegistrationId = cr.StudentRegistrationId AND cr.CourseOfferId = co.CourseOfferId AND co.CourseId = c.CourseId ORDER BY co.Year, co.Quartile, co.CourseOfferId;
WITH InfoSliced(StudentRegistrationId, GPA) AS (SELECT srd.StudentRegistrationId, i.GPA FROM studentregistrationstodegrees srd, info i, degrees d WHERE srd.StudentRegistrationId = i.StudentRegistrationId AND srd.DegreeId = d.DegreeId AND d.TotalEcts <= i.ObtainedEcts AND i.GPA > 9), Failed(StudentRegistrationId) AS (SELECT DISTINCT i.StudentRegistrationId FROM InfoSliced i, CourseRegistrations cr WHERE i.StudentRegistrationId = cr.StudentRegistrationId AND cr.Grade < 5) SELECT DISTINCT srd.StudentId FROM InfoSliced i, StudentRegistrationsToDegrees srd WHERE  i.StudentRegistrationId = srd.StudentRegistrationId AND i.GPA > %1% AND i.StudentRegistrationId NOT IN (SELECT * FROM Failed); 
WITH ActiveStudents(StudentRegistrationId) AS (SELECT srd.StudentRegistrationId FROM StudentRegistrationsToDegrees srd INNER JOIN Degrees d ON (srd.DegreeId = d.DegreeId) LEFT JOIN Info i ON (i.StudentRegistrationId = srd.StudentRegistrationId) WHERE i.ObtainedECTS < d.TotalECTS OR i.ObtainedECTS is null), ActiveStudentsByG(DegreeId, Gender, nr) AS (SELECT srd.DegreeId, s.Gender, COUNT(srd.StudentId) FROM StudentRegistrationsToDegrees srd, Students s, ActiveStudents acts WHERE srd.StudentId = s.StudentId AND acts.StudentRegistrationId = srd.StudentRegistrationId GROUP BY srd.DegreeId, s.Gender), TotalActiveStudents(DegreeId, nr) AS (SELECT asbg.DegreeId, SUM(nr) FROM ActiveStudentsByG asbg GROUP BY asbg.DegreeId) SELECT tas.DegreeId, asbg.nr/(tas.nr*1.0) AS percentage FROM ActiveStudentsByG asbg,TotalActiveStudents tas WHERE asbg.Gender = 'F' AND asbg.DegreeId = tas.DegreeId ORDER BY tas.DegreeId;
WITH AllStudentsByG(Dept, Gender, nr) AS (SELECT d.Dept, s.Gender, COUNT(*) FROM StudentRegistrationsToDegrees srd, Degrees d, Students s WHERE d.DegreeId = srd.DegreeId AND s.StudentId = srd.StudentId GROUP BY Dept, Gender), TotalStudents(Dept, nr) AS (SELECT asbg.Dept, SUM(asbg.nr) FROM AllStudentsByG asbg GROUP BY asbg.Dept) SELECT asbg.nr/(ts.nr*1.0) AS percentage FROM AllStudentsByG asbg, TotalStudents ts WHERE asbg.Gender = 'F' AND asbg.Dept = ts.Dept AND ts.Dept = %1%;
SELECT sg.CourseId, sum(nr)/(total*1.0) AS percentagePassing FROM StudentsByGrade sg, StudentsByCourse sc WHERE sg.CourseId = sc.CourseId AND sg.Grade >= %1% GROUP BY sg.CourseId, total ORDER BY sg.CourseId;
SELECT * FROM ExcellentStudents WHERE numberOfCoursesWhereExcellent >= %1%;
SELECT d.DegreeId, s.BirthYearStudent, s.Gender, AVG(i.GPA) FROM StudentRegistrationsToDegrees srd, Students s, Degrees d, Info i WHERE d.DegreeId = srd.DegreeId AND srd.StudentId = s.StudentId AND i.StudentRegistrationId = srd.StudentRegistrationId AND i.ObtainedECTS < d.TotalECTS GROUP BY CUBE(d.DegreeId, s.BirthYearStudent, s.Gender) ORDER BY d.DegreeId, s.BirthYearStudent, s.Gender;
WITH NecessarySA(CourseOfferId, nr) AS (SELECT cr.CourseOfferId, COUNT(cr.StudentRegistrationID) FROM CourseRegistrations cr GROUP BY cr.CourseOfferId), ActualSA(CourseOfferId, nr) AS (SELECT co.CourseOfferId, COUNT(sa.StudentRegistrationId) FROM CourseOffers co LEFT JOIN StudentAssistants sa ON co.CourseOfferId = sa.CourseOfferId GROUP BY co.CourseOfferId) SELECT c.CourseName, co.Year, co.Quartile FROM NecessarySA nsa, CourseOffers co, Courses c, ActualSA asa WHERE co.CourseOfferId = nsa.CourseOfferId AND co.CourseId = c.CourseId AND asa.CourseOfferId = co.CourseOfferId AND nsa.nr/50 + 1 > asa.nr ORDER BY co.CourseOfferId; 
